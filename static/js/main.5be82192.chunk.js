(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,a){e.exports={root:"ProgrammerLayout_root__32s_m",register_editor:"ProgrammerLayout_register_editor__3nPB9",semi_hidden:"ProgrammerLayout_semi_hidden__1Qtk5",processor:"ProgrammerLayout_processor__h4yOd",left_controls:"ProgrammerLayout_left_controls__26RPC",label:"ProgrammerLayout_label__toU0p",key:"ProgrammerLayout_key___C1uD"}},function(e,t,a){e.exports={root:"Root_root__39OtQ",actions:"Root_actions__UtMJ6",semi_hidden:"Root_semi_hidden__2Z0tJ",info_message:"Root_info_message__1Lxng",error_message:"Root_error_message__2m22s",switch_view_button:"Root_switch_view_button__3DJ62"}},,,,,,function(e,t,a){e.exports={root:"MemoryCellView_root__2Bi1u",focused:"MemoryCellView_focused__2xtz6",use_read:"MemoryCellView_use_read__GaQ6a",use_write:"MemoryCellView_use_write__2x-Wx",use_instruction:"MemoryCellView_use_instruction__3m6zH",use_jump_target:"MemoryCellView_use_jump_target__2Ig6J",use_error:"MemoryCellView_use_error__2MS70"}},function(e,t,a){e.exports={root:"MemoryGrid_root__2kL-I",label:"MemoryGrid_label__IVI4S"}},,,,function(e,t,a){},function(e,t,a){e.exports={root:"FlagCellView_root__fBMTz"}},,function(e,t,a){e.exports=a(30)},,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(20),s=a.n(o),r=(a(29),a(13)),c=a(2),l=a(3),u=a(8),d=a(4),h=a(5),p=a(1),f=a(7),v=a(21),y=a.n(v),m=a(18),b=a(6);function g(e,t){return e&(1<<t)-1}function O(e,t){var a=g(e,t),n=1<<t-1;return a>=n&&(a-=2*n),a}var j,x=a(23),k=Object(f.a)("connection"),w=function(){function e(t,a,n){Object(c.a)(this,e),this.name=t,this.x=a,this.y=n,Object.defineProperty(this,k,{writable:!0,value:void 0})}return Object(l.a)(e,[{key:"setConnection",value:function(e){Object(p.a)(this,k)[k]=e}},{key:"used",set:function(e){e&&void 0!==Object(p.a)(this,k)[k]&&Object(p.a)(this,k)[k].markUsedBy(this)}},{key:"value",get:function(){return void 0===Object(p.a)(this,k)[k]?void 0:Object(p.a)(this,k)[k].value}},{key:"asBoolean",get:function(){var e=this.value;if("string"===typeof e){if("0"===e||"false"===e)return!1;if("1"===e||"true"===e)return!0;throw new Error("Emulator error: "+e+" is not a valid boolean.")}}},{key:"asInteger",get:function(){var e=this.value;if("string"===typeof e){var t=parseInt(e);if(isNaN(t))throw new I("Expected a number, but got "+e+" instead.");return t}}}]),e}(),C=Object(f.a)("value"),E=Object(f.a)("connection"),N=function(){function e(t,a,n){Object(c.a)(this,e),this.name=t,this.x=a,this.y=n,Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0})}return Object(l.a)(e,[{key:"clear",value:function(){this.value=void 0}},{key:"connection",set:function(e){Object(p.a)(this,E)[E]=e}},{key:"used",get:function(){var e;return(null===(e=Object(p.a)(this,E)[E])||void 0===e?void 0:e.used)||!1}},{key:"value",get:function(){return Object(p.a)(this,C)[C]},set:function(e){Object(p.a)(this,C)[C]=e}},{key:"asUserText",get:function(){var e=this.value;return void 0===e?"?":e}},{key:"asBoolean",set:function(e){this.value="boolean"===typeof e?e?"1":"0":void 0}},{key:"asInteger",set:function(e){this.value="number"===typeof e?e.toFixed(0):void 0}}]),e}(),A=function(){function e(t,a,n,i,o){Object(c.a)(this,e),this.type=a,this.id=n,this.x=i,this.y=o}return Object(l.a)(e,[{key:"eval",value:function(){}},{key:"evalClock",value:function(){}},{key:"reset",value:function(){}},{key:"clearHighlights",value:function(){}},{key:"connectInput",value:function(e,t){var a=this[e];if(!(a instanceof w))throw new Error("Emulator error: ".concat(this.type," has no input named ").concat(e,"."));t.connectInput(this,a)}},{key:"connectOutput",value:function(e,t){var a=this[e];if(!(a instanceof N))throw new Error("Emulator error: ".concat(this.type," has no output named ").concat(e,"."));t.connectOutput(this,a)}}]),e}(),I=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(Object(x.a)(Error)),D=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"ALU",n,i,o)).in0=new w("in0",0,15),r.in1=new w("in0",0,65),r.op=new w("op",20,70),r.cin=new w("cin",30,65),r.out=new N("out",40,40),r.flags=new N("flags",20,10),r.nBits=void 0,r.nBits=s.nbits,r}return Object(l.a)(a,[{key:"finishUp",value:function(e,t,a){var n=0,i=1<<this.nBits;(e&i)===i&&(n+=4,e-=i);var o=i>>1,s=0;(e&o)===o&&(n+=1,s+=1),(t&o)===o&&(s+=4),(a&o)===o&&(s+=2),1!==s&&6!==s||(n+=8),0===e&&(n+=2),this.out.asInteger=O(e,this.nBits),this.flags.asInteger=n}},{key:"doADD",value:function(){var e=this.in0.asInteger,t=this.in1.asInteger;if(void 0!==e&&void 0!==t){var a=e+t;this.finishUp(a,e,t)}}},{key:"doSUB",value:function(){var e=this.in0.asInteger,t=this.in1.asInteger;if(void 0!==e&&void 0!==t){var a=g(1+~t,this.nBits),n=e+a;this.finishUp(n,e,a)}}},{key:"doAND",value:function(){var e=this.in0.asInteger,t=this.in1.asInteger;if(void 0!==e&&void 0!==t){var a=e&t;this.finishUp(a,e,t)}}},{key:"doOR",value:function(){var e=this.in0.asInteger,t=this.in1.asInteger;if(void 0!==e&&void 0!==t){var a=e|t;this.finishUp(a,e,t)}}},{key:"doXOR",value:function(){var e=this.in0.asInteger,t=this.in1.asInteger;if(void 0!==e&&void 0!==t){var a=e^t;this.finishUp(a,e,t)}}},{key:"doINC",value:function(){var e=this.in0.asInteger;if(void 0!==e){var t=e+1;this.finishUp(t,e,1)}}},{key:"doINCB",value:function(){var e=this.in1.asInteger;if(void 0!==e){var t=e+1;this.finishUp(t,1,e)}}},{key:"doDEC",value:function(){var e=this.in0.asInteger;if(void 0!==e){var t=g(-1,this.nBits),a=e+t;this.finishUp(a,e,t)}}},{key:"doDECB",value:function(){var e=this.in1.asInteger;if(void 0!==e){var t=g(-1,this.nBits),a=t+e;this.finishUp(a,t,e)}}},{key:"doCMA",value:function(){var e=this.in0.asInteger;if(void 0!==e){var t=g(~e,this.nBits);this.finishUp(t,e,0)}}},{key:"doNEG",value:function(){var e=this.in0.asInteger;if(void 0!==e){var t=g(1+~e,this.nBits);this.finishUp(t,e,0)}}},{key:"doRAL",value:function(){var e=this.in0.asInteger,t=this.cin.asBoolean;if(void 0!==e&&void 0!==t){var a=(e<<1)+(t?1:0);this.finishUp(a,e,0)}}},{key:"doRAR",value:function(){var e=this.in0.asInteger,t=this.cin.asBoolean;if(void 0!==e&&void 0!==t){var a=1<<this.nBits,n=e;t&&(n+=a),n>>=1,0!==(1&e)&&(n|=a),this.finishUp(n,e,0)}}},{key:"doZERO",value:function(){this.out.asInteger=0,this.flags.asInteger=2}},{key:"doONES",value:function(){this.out.asInteger=-1,this.flags.asInteger=1}},{key:"eval",value:function(){this.out.clear(),this.flags.clear();var e=this.op.value;if(void 0!==e)switch(e){case"ADD":this.doADD();break;case"AND":this.doAND();break;case"INC":this.doINC();break;case"INCB":this.doINCB();break;case"DEC":this.doDEC();break;case"DECB":this.doDECB();break;case"ZERO":this.doZERO();break;case"RAL":this.doRAL();break;case"RAR":this.doRAR();break;case"CMA":this.doCMA();break;case"NEG":this.doNEG();break;case"ONES":this.doONES();break;case"SUB":this.doSUB();break;case"OR":this.doOR();break;case"XOR":this.doXOR();break;default:throw new Error("Evaluating ALU "+this.id+": Op input has unknown value "+e)}}},{key:"render",value:function(e,t){return i.a.createElement(M,{key:e,c:this,d:t})}}]),a}(A),M=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")";return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("path",{d:"M0 0 L40 20 V60 L0 80 V50 L20 40 L0 30 Z"}))}}]),a}(i.a.Component);!function(e){e[e.Inactive=0]="Inactive",e[e.Conflict=1]="Conflict"}(j||(j={}));var R=Object(f.a)("inputs"),_=Object(f.a)("usedBy"),B=function(){function e(){Object(c.a)(this,e),Object.defineProperty(this,R,{writable:!0,value:[]}),Object.defineProperty(this,_,{writable:!0,value:[]}),this.connectedInputPins=[],this.connectedOutputPins=[]}return Object(l.a)(e,[{key:"markUsedBy",value:function(e){Object(p.a)(this,_)[_].includes(e)||Object(p.a)(this,_)[_].push(e)}},{key:"clearUsedBy",value:function(){Object(p.a)(this,_)[_]=[]}},{key:"connectInput",value:function(e,t){t.setConnection(this),this.connectedInputPins.push({c:e,p:t})}},{key:"connectOutput",value:function(e,t){t.connection=this,Object(p.a)(this,R)[R].push(t),this.connectedOutputPins.push({c:e,p:t})}},{key:"used",get:function(){return Object(p.a)(this,_)[_].length>0}},{key:"usedBy",get:function(){return Object(p.a)(this,_)[_]}},{key:"displayValue",get:function(){var e,t=0,a=j.Inactive,n=Object(b.a)(Object(p.a)(this,R)[R]);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(void 0!==i.value){if(0!==t)return j.Conflict;a=i.value,t=1}}}catch(o){n.e(o)}finally{n.f()}return a}},{key:"value",get:function(){var e,t=void 0,a=Object(b.a)(Object(p.a)(this,R)[R]);try{for(a.s();!(e=a.n()).done;){var n=e.value;void 0!==n.value&&(t=n.value)}}catch(i){a.e(i)}finally{a.f()}return t}},{key:"activeInput",get:function(){var e,t=void 0,a=Object(b.a)(Object(p.a)(this,R)[R]);try{for(a.s();!(e=a.n()).done;){var n=e.value;void 0!==n.value&&(t=n)}}catch(i){a.e(i)}finally{a.f()}return t}}]),e}(),L=Object(f.a)("options"),S=Object(f.a)("value"),P=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;Object(c.a)(this,a),(r=t.call(this,e,"Control",n,i,o)).out=void 0,Object.defineProperty(Object(u.a)(r),L,{writable:!0,value:void 0}),r.width=void 0,r.height=20,Object.defineProperty(Object(u.a)(r),S,{writable:!0,value:0}),r.name=void 0,r.top=void 0;var l=!1!==s.top;r.top=l;var d=s.name||"Unnamed";r.name=d;var h=s.options;return Object(p.a)(Object(u.a)(r),L)[L]=h,r.width=s.wid||60,void 0!==Object(p.a)(Object(u.a)(r),L)[L]&&Object(p.a)(Object(u.a)(r),L)[L].splice(0,0,"none"),r.out=l?new N("out",r.width/2,0):new N("out",r.width,r.height/2),r}return Object(l.a)(a,[{key:"eval",value:function(){void 0===Object(p.a)(this,L)[L]?this.out.asBoolean=1===Object(p.a)(this,S)[S]:0===Object(p.a)(this,S)[S]?this.out.clear():this.out.value=Object(p.a)(this,L)[L][Object(p.a)(this,S)[S]]}},{key:"reset",value:function(){Object(p.a)(this,S)[S]=0}},{key:"toggle",value:function(){void 0===Object(p.a)(this,L)[L]?Object(p.a)(this,S)[S]=1-Object(p.a)(this,S)[S]:Object(p.a)(this,S)[S]=(Object(p.a)(this,S)[S]+1)%Object(p.a)(this,L)[L].length}},{key:"getValueOfOption",value:function(e){if(void 0===Object(p.a)(this,L)[L]){if(!0===e)return 1;if(!1===e)return 0;throw new Error(this.name+" does not have custom options, you must use true/false instead.")}if("boolean"===typeof e)throw new Error(this.name+" has custom options, it cannot be set with true/false.");for(var t=0;t<Object(p.a)(this,L)[L].length;t++)if(Object(p.a)(this,L)[L][t]===e)return t;throw new Error(this.name+" has no option named "+e)}},{key:"setValue",value:function(e){Object(p.a)(this,S)[S]=e}},{key:"render",value:function(e,t){return i.a.createElement(T,{key:e,c:this,d:t})}},{key:"label",get:function(){return void 0===Object(p.a)(this,L)[L]?this.name:Object(p.a)(this,L)[L][Object(p.a)(this,S)[S]]}},{key:"active",get:function(){return Object(p.a)(this,S)[S]>0}}]),a}(A),T=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.c,a=t.x,n=t.y,o=t.width,s=t.height,r=t.label,c=a,l=n,u={x:c+4,y:n+s-4},d="control "+(t.active?"active":"inactive");return i.a.createElement("g",{className:"component",onClick:function(){e.props.d.decoderEnabled=!1,e.props.c.toggle(),e.props.d.eval()}},i.a.createElement("rect",{className:d,x:c,y:l,width:o,height:s}),i.a.createElement("text",Object.assign({className:"label"},u),r))}}]),a}(i.a.Component);function V(e,t,a){if(e.includes("-")){var n=e.split("-")[1],i=parseInt(n);return function(){var e=t.value;return console.log(e),void 0===e?"?":""+(parseInt(e)-i)}}if(e.includes("+")){var o=e.split("+")[1],s=parseInt(o);return function(){var e=t.value;return console.log(e),void 0===e?"?":""+(parseInt(e)+s)}}if(e.includes("?")){var r=e.split("?")[1].split(":");return function(){var e=t.value;return console.log(e),"true"===e||"1"===e?r[0]:r[1]}}return function(){var e=t.value;return void 0===e?"?":e}}function U(e,t){var a,n=[],i="",o=!1,s=Object(b.a)(e);try{for(s.s();!(a=s.n()).done;){var r=a.value;if("<"!==r||o)if(">"===r&&o){var c,l=i.split(/[-+?]/)[0],u=!1,d=Object(b.a)(t.components);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(h.id===l){u=!0;var p=h.out;if(!(p instanceof N))throw new Error("The component "+l+' does not have an output named "out", so it cannot be used in this expression:\n'+e);n.push(V(i,p))}}}catch(f){d.e(f)}finally{d.f()}if(!u)throw new Error("There is no component with ID "+l);i="",o=!1}else i+=r;else!function(){var e=""+i;n.push(function(){return e}),i="",o=!0}()}}catch(f){s.e(f)}finally{s.f()}return n.push(function(){return i}),function(){var e,t="",a=Object(b.a)(n);try{for(a.s();!(e=a.n()).done;){t+=(0,e.value)()}}catch(f){a.e(f)}finally{a.f()}return t}}var H=function e(t,a){Object(c.a)(this,e),this.makeMessage=t,this.nextCycleOverride=a};function Z(e,t,a,n,i){if(0===t.trim().length)return function(){return new H(!1,-1)};var o=[],s=!1,r=-1;n&&(r=0,s=!i);var c,l=Object(b.a)(t.trim().split(","));try{for(l.s();!(c=l.n()).done;){var u=c.value.trim().split(":"),d=u[0],h=!0;u.length>1&&(h=u[1]);var p,f=!1,v=Object(b.a)(a.controls);try{for(v.s();!(p=v.n()).done;){var y=p.value;if(y.name===d){f=!0;var m=y.getValueOfOption(h);o.push({control:y,value:m});break}}}catch(g){v.e(g)}finally{v.f()}if("!message"===d)s=!0;else if("!next"===d){if(!0===h)throw new Error("!next must be followed by the name of a cycle, E.G. !next:t1");if(-1===(r=e.indexOf(h)))throw new Error("There is no cycle named "+h)}else if(!f)throw new Error("There is no control named "+d)}}catch(g){l.e(g)}finally{l.f()}return function(){var e,t=Object(b.a)(o);try{for(t.s();!(e=t.n()).done;){var a=e.value,n=a.control,i=a.value;n.setValue(i)}}catch(g){t.e(g)}finally{t.f()}return new H(s,r)}}var F=function e(){Object(c.a)(this,e),this.clockCycleNames=["t0"],this.fetchCycleAction=function(){return new H(!1,-1)},this.instructions=[]},$=Object(f.a)("enabled"),W=Object(f.a)("datapath"),J=Object(f.a)("microcode"),Q=Object(f.a)("currentCycle"),G=Object(f.a)("lastInstrDesc"),Y=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Decoder",n,i,o)).in=new w("in",0,10),Object.defineProperty(Object(u.a)(r),$,{writable:!0,value:!0}),Object.defineProperty(Object(u.a)(r),W,{writable:!0,value:void 0}),Object.defineProperty(Object(u.a)(r),J,{writable:!0,value:void 0}),Object.defineProperty(Object(u.a)(r),Q,{writable:!0,value:0}),Object.defineProperty(Object(u.a)(r),G,{writable:!0,value:""}),e.decoder=Object(u.a)(r),Object(p.a)(Object(u.a)(r),W)[W]=e,Object(p.a)(Object(u.a)(r),J)[J]=new F,r}return Object(l.a)(a,[{key:"loadMicrocode",value:function(e){Object(p.a)(this,J)[J]=function(e,t){var a=new F;a.clockCycleNames=e.clockCycleNames;var n=a.clockCycleNames;a.fetchCycleAction=Z(n,e.fetchCycleStep,t,!1,!1);var i,o=Object(b.a)(e.instructions);try{for(o.s();!(i=o.n()).done;){var s=i.value.trim().split(";"),r=s[0],c=s[1],l=s.slice(2);if(l.length>a.clockCycleNames.length-1)throw new Error("The instruction "+c+" has too many steps! Try adding another step to clockCycleNames.");for(var u=[],d=!1,h=0;h<l.length;h++){var p=h===l.length-1,f=Z(n,l[h].trim(),t,p,d);u.push(f),d=d||l[h].includes("!message")}a.instructions.push({opcode:c.trim(),messageGenerator:U(r,t),steps:u})}}catch(v){o.e(v)}finally{o.f()}return a}(e,Object(p.a)(this,W)[W])}},{key:"getCurrentInstruction",value:function(){var e=this.in.value;if(void 0===e)throw new I("Uninitialized value used as instruction.");var t=e.trim().split(" ").reverse().pop();if(void 0===t)throw new I(e+" is not a valid instruction.");var a,n=Object(b.a)(Object(p.a)(this,J)[J].instructions);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.opcode===t)return i}}catch(o){n.e(o)}finally{n.f()}throw new I(t+" is not a valid instruction opcode.")}},{key:"doCurrentStepAction",value:function(){if(0===Object(p.a)(this,Q)[Q])return Object(p.a)(this,J)[J].fetchCycleAction();if("HLT"===this.in.value)Object(p.a)(this,W)[W].haltRequested=!0;else{var e=this.getCurrentInstruction().steps;if(Object(p.a)(this,Q)[Q]-1<e.length)return e[Object(p.a)(this,Q)[Q]-1]()}return new H(!1,-1)}},{key:"eval",value:function(){if(Object(p.a)(this,$)[$]){var e,t=Object(p.a)(this,W)[W],a=Object(b.a)(t.controls);try{for(a.s();!(e=a.n()).done;){e.value.reset()}}catch(o){a.e(o)}finally{a.f()}var n=this.doCurrentStepAction();if(void 0!==this.in.value&&"HLT"!==this.in.value){var i=this.getCurrentInstruction();n.makeMessage&&(Object(p.a)(this,G)[G]=i.messageGenerator())}}}},{key:"evalClock",value:function(){if(Object(p.a)(this,$)[$]){var e=this.doCurrentStepAction();e.nextCycleOverride>=0?Object(p.a)(this,Q)[Q]=e.nextCycleOverride:(Object(p.a)(this,Q)[Q]+=1,Object(p.a)(this,Q)[Q]===Object(p.a)(this,J)[J].clockCycleNames.length&&(Object(p.a)(this,Q)[Q]=0)),Object(p.a)(this,W)[W].decoderCycleFinished=0===Object(p.a)(this,Q)[Q]}}},{key:"getInstructionDescription",value:function(){return"HLT"===this.in.value?"Processor halted.":Object(p.a)(this,G)[G]}},{key:"reset",value:function(){Object(p.a)(this,Q)[Q]=0}},{key:"render",value:function(e,t){return i.a.createElement(z,{key:e,c:this,d:t})}},{key:"enabled",get:function(){return Object(p.a)(this,$)[$]},set:function(e){Object(p.a)(this,$)[$]=e,Object(p.a)(this,W)[W].eval()}},{key:"statusDesc",get:function(){return Object(p.a)(this,J)[J].clockCycleNames[Object(p.a)(this,Q)[Q]]}}]),a}(A),z=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.c,a=t.x,n=t.y,o=t.enabled,s=t.statusDesc,r="translate("+a+","+n+")";return i.a.createElement("g",{transform:r,className:"component",onClick:function(){if(e.props.c.enabled=!o,!1===e.props.c.enabled){var t,a=Object(b.a)(e.props.d.controls);try{for(a.s();!(t=a.n()).done;)t.value.reset()}catch(n){a.e(n)}finally{a.f()}}e.props.d.eval()}},i.a.createElement("rect",{x:0,y:0,width:50,height:20,className:o?"active":"inactive"}),i.a.createElement("text",{className:"small-label",x:25,y:13,textAnchor:"middle"},"decoder"),i.a.createElement("text",{className:"value",x:0,y:35},s))}}]),a}(i.a.Component),q=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Expand",n,i,o)).in=new w("in",0,25),r.out=new N("out",20,25),r.inNBits=void 0,r.outNBits=void 0,r.extend=void 0,r.inNBits=s.inNBits,r.outNBits=s.outNBits,r.extend=!0===s.extend,r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.in.value;if(void 0!==e){var t=parseInt(e.trim().split(" ").pop()||"asdfasdf");t=g(t,this.inNBits);var a=g(t,this.outNBits);if(this.outNBits>this.inNBits&&this.extend)if(0!==(t&1<<this.inNBits-1))a|=(1<<this.outNBits)-(1<<this.inNBits);this.out.asInteger=a,this.in.used=this.out.used}else this.out.clear()}},{key:"render",value:function(e,t){return i.a.createElement(X,{key:e,c:this,d:t})}}]),a}(A),X=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")";return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("line",{key:3,x1:0,y1:10,x2:0,y2:40}),i.a.createElement("line",{key:4,x1:0,y1:10,x2:20,y2:0}),i.a.createElement("line",{key:5,x1:0,y1:40,x2:20,y2:50}),i.a.createElement("line",{key:6,x1:20,y1:0,x2:20,y2:50}))}}]),a}(i.a.Component),K=Object(f.a)("label"),ee=Object(f.a)("value"),te=function(){function e(t){Object(c.a)(this,e),Object.defineProperty(this,K,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),this.lastUse="none",Object(p.a)(this,K)[K]=t}return Object(l.a)(e,[{key:"clearLastUse",value:function(){this.lastUse="none"}},{key:"lastUseCssClass",get:function(){return"use_"+this.lastUse}},{key:"label",get:function(){return Object(p.a)(this,K)[K]}},{key:"value",set:function(e){Object(p.a)(this,ee)[ee]=e},get:function(){return Object(p.a)(this,ee)[ee]}}]),e}(),ae=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(te),ne=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(te);function ie(e){return void 0===e?e:!e}function oe(e,t){return void 0===e?void 0:(e&1<<t)>0}function se(e){return void 0===e?"?":!0===e?"T":"F"}var re=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"FlagLogic",n,i,o)).in=new w("in",30,30),r.op=new w("op",0,15),r.out=new N("out",30,0),r.flagN=new ne("NEG"),r.flagZ=new ne("ZERO"),r.flagC=new ne("CARRY"),r.flagV=new ne("V"),r.flagTZ=new ne("TZ"),e.visibleFlags.push(r.flagC),e.visibleFlags.push(r.flagZ),e.visibleFlags.push(r.flagN),r}return Object(l.a)(a,[{key:"eval",value:function(){this.out.clear();var e=this.op.value;if(void 0!==e){var t=void 0;switch(e){case"RDTZ":t=this.flagTZ.value;break;case"RDC":t=this.flagC.value;break;case"RDZ":t=this.flagZ.value;break;case"RDN":t=this.flagN.value;break;case"RDV":t=this.flagV.value;break;case"RDNC":t=ie(this.flagC.value);break;case"RDNZ":t=ie(this.flagZ.value);break;case"RDNN":t=ie(this.flagN.value);break;case"RDNV":t=ie(this.flagV.value);break;case"ROT":t=this.flagC.value,this.in.used=!0;break;case"LDZ":case"LDALL":case"LDTZ":case"CLC":case"STC":case"CMC":this.in.used=!0;break;default:throw new Error("Evaluating DPFlagLogic "+this.id+": Op input has unknown value "+e)}this.out.asBoolean=t}}},{key:"evalClock",value:function(){var e=this.op.value;if(void 0!==e){var t=this.in.asInteger;switch(e){case"RDTZ":case"RDC":case"RDZ":case"RDN":case"RDV":case"RDNC":case"RDNZ":case"RDNN":case"RDNV":return;case"ROT":this.flagC.value=oe(t,1);break;case"LDZ":this.flagZ.value=oe(t,1);break;case"LDALL":this.flagN.value=oe(t,0),this.flagZ.value=oe(t,1),this.flagC.value=oe(t,2),this.flagV.value=oe(t,3);break;case"LDTZ":this.flagZ.value=oe(t,1);break;case"CLC":this.flagC.value=!1;break;case"STC":this.flagC.value=!0;break;case"CMC":this.flagC.value=ie(this.flagC.value);break;default:throw new Error("Evaluating DPFlagLogic "+this.id+": Op input has unknown value "+e)}}}},{key:"reset",value:function(){this.flagC.value=!1,this.flagN.value=!1,this.flagTZ.value=!1,this.flagV.value=!1,this.flagZ.value=!1}},{key:"render",value:function(e,t){return i.a.createElement(ce,{key:e,c:this,d:t})}}]),a}(A),ce=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")",a=this.props.c,n=this.props.c.in.asInteger,o=se(oe(n,4))+" "+se(oe(n,3))+" "+se(oe(n,2))+" "+se(oe(n,1))+" "+se(oe(n,0)),s=se(a.flagTZ.value)+" "+se(a.flagV.value)+" "+se(a.flagC.value)+" "+se(a.flagZ.value)+" "+se(a.flagN.value);return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("path",{d:"M0 0 H 60 V 30 H 0 Z"}),i.a.createElement("text",{className:"small-label",x:30,y:10,textAnchor:"middle"},s),i.a.createElement("text",{className:"small-label",x:30,y:19,textAnchor:"middle"},"T V C Z N"),i.a.createElement("text",{className:"small-label",x:30,y:28,textAnchor:"middle"},o))}}]),a}(i.a.Component),le=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"And",n,i,o)).in0=new w("in0",0,5),r.in1=new w("in1",0,15),r.out=new N("out",20,10),r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.in0.asBoolean,t=this.in1.asBoolean;void 0===e||void 0===t?this.out.clear():(this.out.asBoolean=e&&t,this.in0.used=this.out.used&&e&&t,this.in1.used=this.out.used&&e&&t)}},{key:"render",value:function(e,t){return i.a.createElement(ue,{key:e,c:this,d:t})}}]),a}(A),ue=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t=e.x,a=e.y,n="translate(".concat(t,", ").concat(a,")");return i.a.createElement("g",{transform:n,className:"component"},i.a.createElement("path",{d:"M0 0 H10 A10 10 0 0 1 10 20 H 0 Z"}))}}]),a}(i.a.Component),de=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Or",n,i,o)).in0=new w("in0",0,5),r.in1=new w("in1",0,15),r.out=new N("out",20,10),r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.in0.asBoolean,t=this.in1.asBoolean;void 0===e||void 0===t?this.out.clear():(this.out.asBoolean=e||t,this.in0.used=this.out.used&&e,this.in1.used=this.out.used&&t)}},{key:"render",value:function(e,t){return i.a.createElement(he,{key:e,c:this,d:t})}}]),a}(A),he=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t=e.x,a=e.y,n="translate(".concat(t,", ").concat(a,")");return i.a.createElement("g",{transform:n,className:"component"},i.a.createElement("path",{d:"M-3.7 0 A33 33 0 0 1 20 10 A33 33 0 0 1 -3.7 20 A13 13 0 0 0 -3.7 0 Z"}))}}]),a}(i.a.Component),pe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"AndOr",n,i,o)).in0=new w("in0",20,5),r.in1=new w("in1",0,15),r.in2=new w("in2",0,25),r.out=new N("out",40,10),r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.in0.asBoolean,t=this.in1.asBoolean,a=this.in2.asBoolean;!0===e||!0===t&&!0===a?this.out.asBoolean=!0:void 0===e||void 0===t||void 0===a?this.out.clear():this.out.asBoolean=!1,void 0!==e&&(this.in0.used=this.out.used&&e),void 0!==t&&void 0!==a&&(this.in1.used=this.out.used&&t&&a,this.in2.used=this.out.used&&t&&a)}},{key:"render",value:function(e,t){return i.a.createElement(fe,{key:e,c:this,d:t})}}]),a}(A),fe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t=e.x,a=e.y,n="translate(".concat(t,", ").concat(a,")");return i.a.createElement("g",{transform:n,className:"component"},i.a.createElement("path",{d:"M16.3 0 A33 33 0 0 1 40 10 A33 33 0 0 1 16.3 20 A13 13 0 0 0 16.3 0 Z"}),i.a.createElement("path",{d:"M0 10 H10 A10 10 0 0 1 10 30 H 0 Z"}))}}]),a}(i.a.Component),ve=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Incrementer",n,i,o)).in=new w("in",0,15),r.out=new N("out",30,15),r.nbits=void 0,r.constant=void 0,r.nbits=s.nbits,r.constant=s.constant,r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.in.asInteger;void 0!==e?(e=g(e,this.nbits)+this.constant,this.out.asInteger=g(e,this.nbits),this.in.used=this.out.used):this.out.clear()}},{key:"render",value:function(e,t){return i.a.createElement(ye,{key:e,c:this,d:t})}}]),a}(A),ye=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")",a=this.props.c.constant,n=(a>=0?"+":"")+a,o=this.props.c.out.asUserText;return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("circle",{cx:15,cy:15,r:15}),i.a.createElement("text",{x:15,y:20,textAnchor:"middle",className:"label"},n),i.a.createElement("text",{x:33,y:12,className:"value"},o))}}]),a}(i.a.Component),me=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Latch",n,i,o)).in=new w("in",0,10),r.load=new w("load",10,50),r.out=new N("out",30,10),r.name=void 0,r.resetValue=void 0,r.nbits=void 0,r.data=void 0,r.signed=void 0,r.name=s.name||"Unnamed",r.data=new ae(r.name),r.resetValue=s.resetValue,void 0!==r.resetValue&&(r.resetValue=""+r.resetValue),r.nbits=s.nbits,!0===s.visible&&e.visibleRegisters.push(r.data),r.signed=!1!==s.signed,r}return Object(l.a)(a,[{key:"eval",value:function(){this.out.value=this.data.value,this.in.used=!0===this.load.asBoolean,this.load.used=!0===this.load.asBoolean}},{key:"evalClock",value:function(){if(!0===this.load.asBoolean){if(void 0===this.nbits)this.data.value=this.in.value;else{var e=this.in.asInteger;void 0!==e?(e=this.signed?O(e,this.nbits):g(e,this.nbits),this.data.value=""+e):this.data.value=void 0}if(void 0===this.data.value)throw this.data.lastUse="error",new I("Register "+this.name+" assigned invalid/uninitialized data.");this.data.lastUse="write"}else void 0!==this.data.value&&this.out.used&&"none"===this.data.lastUse&&(this.data.lastUse="read")}},{key:"reset",value:function(){this.data.value=this.resetValue}},{key:"clearHighlights",value:function(){this.data.clearLastUse()}},{key:"render",value:function(e,t){return i.a.createElement(be,{key:e,c:this,d:t})}}]),a}(A),be=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")",a=this.props.c.name,n=this.props.c.data.value,o=void 0===n?"?":n;return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("rect",{x:0,y:0,width:30,height:50,className:this.props.c.data.lastUseCssClass}),i.a.createElement("text",{className:"label",x:15,y:23,textAnchor:"middle"},a),i.a.createElement("text",{className:"value",x:0,y:-2},o))}}]),a}(i.a.Component),ge=Object(f.a)("cells"),Oe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;Object(c.a)(this,a),(r=t.call(this,e,"MainMemory",n,i,o)).addr=void 0,r.memr=void 0,r.memw=void 0,r.din=void 0,r.dout=void 0,r.highlight_instr=new w("highlight_instr",0,400),r.highlight_jumpt=new w("highlight_jumpt",0,425),r.highlight_addr=new w("highlight_addr",0,450),r.addrbits=void 0,r.databits=void 0,r.length=void 0,Object.defineProperty(Object(u.a)(r),ge,{writable:!0,value:void 0}),r.addrbits=s.addrbits,r.databits=s.databits,r.length=1<<r.addrbits,Object(p.a)(Object(u.a)(r),ge)[ge]=[];for(var l=0;l<r.length;l++)Object(p.a)(Object(u.a)(r),ge)[ge].push(new ae("Memory Cell ".concat(l)));return e.mainMemoryBlock=Object(p.a)(Object(u.a)(r),ge)[ge],r.addr=new w("addr",0,s.addrY||0),r.memr=new w("memr",0,s.memrY||0),r.memw=new w("memw",0,s.memwY||0),r.din=new w("din",0,s.dataY||0),r.dout=new N("dout",0,(s.dataY||0)-20),r}return Object(l.a)(a,[{key:"eval",value:function(){this.dout.clear();var e=this.addr.asInteger;if(void 0!==e){if(e>=this.length||e<0)throw new I("there is no memory cell at address "+e);if(!0===this.memr.asBoolean){if(!0===this.memw.asBoolean)return;this.dout.value=Object(p.a)(this,ge)[ge][e].value,this.addr.used=!0,this.memr.used=!0}else!0===this.memw.asBoolean&&(this.addr.used=!0,this.din.used=!0,this.memw.used=!0);!0===this.highlight_instr.asBoolean&&(this.highlight_instr.used=!0),!0===this.highlight_jumpt.asBoolean&&(this.highlight_jumpt.used=!0),!0===this.highlight_addr.asBoolean&&(this.highlight_addr.used=!0),!0!==this.highlight_instr.asBoolean&&!0!==this.highlight_jumpt.asBoolean&&!0!==this.highlight_addr.asBoolean||(this.addr.used=!0)}}},{key:"evalClock",value:function(){var e=this.addr.asInteger;if(void 0!==e){if(e>=this.length||e<0)throw new I("There is no memory cell at address "+e);var t="none";if(!1===this.memw.asBoolean&&!0===this.memr.asBoolean?t="read":!0===this.memw.asBoolean&&!1===this.memr.asBoolean&&(t="write",Object(p.a)(this,ge)[ge][e].value=this.din.value),"read"===t&&void 0===this.dout.value?t="error":(!0===this.highlight_instr.asBoolean&&(t="instruction"),!0===this.highlight_jumpt.asBoolean&&(t="jump_target"),!0===this.highlight_addr.asBoolean&&(t="address")),Object(p.a)(this,ge)[ge][e].lastUse=t,"error"===t)throw new I("Cannot read from uninitialized memory at address "+e)}}},{key:"clearHighlights",value:function(){var e,t=Object(b.a)(Object(p.a)(this,ge)[ge]);try{for(t.s();!(e=t.n()).done;){e.value.lastUse="none"}}catch(a){t.e(a)}finally{t.f()}}},{key:"render",value:function(e,t){return i.a.createElement(je,{key:e,c:this,d:t})}}]),a}(A),je=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")";return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("rect",{x:0,y:0,width:30,height:500}),i.a.createElement("text",{className:"label",x:10,y:250,textAnchor:"middle",transform:"rotate(90, 10, 250)"},"Main Memory"))}}]),a}(i.a.Component),xe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Mux",n,i,o)).in0=new w("in0",0,10),r.in1=new w("in1",0,40),r.sel=new w("sel",10,45),r.out=new N("out",20,25),r.inNBits=void 0,r.outNBits=void 0,r.extend=void 0,r.inNBits=s.inNBits,r.outNBits=s.outNBits,r.extend=!0===s.extend,r}return Object(l.a)(a,[{key:"eval",value:function(){var e=this.sel.asBoolean;void 0!==e?e?(this.out.value=this.in1.value,this.in1.used=this.out.used,this.sel.used=!0):(this.out.value=this.in0.value,this.in0.used=this.out.used):this.out.clear()}},{key:"render",value:function(e,t){return i.a.createElement(ke,{key:e,c:this,d:t})}}]),a}(A),ke=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")";return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("text",{key:1,x:3,y:20,className:"label"},"0"),i.a.createElement("text",{key:2,x:3,y:42,className:"label"},"1"),i.a.createElement("line",{key:3,x1:0,y1:0,x2:0,y2:50}),i.a.createElement("line",{key:4,x1:0,y1:0,x2:20,y2:10}),i.a.createElement("line",{key:5,x1:0,y1:50,x2:20,y2:40}),i.a.createElement("line",{key:6,x1:20,y1:10,x2:20,y2:40}))}}]),a}(i.a.Component),we=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Probe",n,i,o)).in=new w("in",0,10),r.width=void 0,r.width=s.wid||70,r}return Object(l.a)(a,[{key:"render",value:function(e,t){return i.a.createElement(Ce,{key:e,c:this,d:t})}}]),a}(A),Ce=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t=e.x,a=e.y,n=e.in,o=e.width,s="translate("+t+","+a+")",r=n.value||"?";return i.a.createElement("g",{transform:s,className:"component"},i.a.createElement("text",{key:1,className:"label",x:15,y:15},r),i.a.createElement("line",{key:3,x1:10,y1:0,x2:o,y2:0}),i.a.createElement("line",{key:4,x1:10,y1:20,x2:o,y2:20}),i.a.createElement("line",{key:5,x1:o,y1:0,x2:o,y2:20}),i.a.createElement("line",{key:6,x1:0,y1:10,x2:10,y2:0}),i.a.createElement("line",{key:7,x1:0,y1:10,x2:10,y2:20}))}}]),a}(i.a.Component),Ee=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n,i,o,s){var r;Object(c.a)(this,a),(r=t.call(this,e,"Tristate",n,i,o)).in=void 0,r.enable=new w("enable",15,30),r.out=void 0,r.flip=void 0;var l=!0===s.flip;return r.flip=l,r.in=new w("in",l?30:0,20),r.out=new N("out",l?0:30,20),r}return Object(l.a)(a,[{key:"eval",value:function(){if(!0===this.enable.asBoolean){this.enable.used=!0;var e=this.in.value;if(void 0!==e)return this.out.value=e,void(this.in.used=this.out.used)}this.out.clear()}},{key:"render",value:function(e,t){return i.a.createElement(Ne,{key:e,c:this,d:t})}}]),a}(A),Ne=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t="translate("+e.x+","+e.y+")",a=e.flip?30:0,n=30-a;return i.a.createElement("g",{transform:t,className:"component"},i.a.createElement("line",{key:3,x1:a,y1:0,x2:a,y2:40}),i.a.createElement("line",{key:4,x1:a,y1:0,x2:n,y2:20}),i.a.createElement("line",{key:5,x1:a,y1:40,x2:n,y2:20}))}}]),a}(i.a.Component),Ae=function e(){Object(c.a)(this,e),this.connections=[],this.distance=0},Ie=function(){function e(t){Object(c.a)(this,e),this.nodes=[];for(var a=0;a<t;a++)this.nodes.push(new Ae)}return Object(l.a)(e,[{key:"addBidirectionalConnection",value:function(e,t){e!==t&&(this.nodes[e].connections.includes(t)||this.nodes[e].connections.push(t),this.nodes[t].connections.includes(e)||this.nodes[t].connections.push(e))}},{key:"propogateDistance",value:function(e){var t,a=this.nodes[e].distance,n=[],i=Object(b.a)(this.nodes[e].connections);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=this.nodes[o];s.distance>a+1&&(s.distance=a+1,n.push(o))}}catch(u){i.e(u)}finally{i.f()}for(var r=0,c=n;r<c.length;r++){var l=c[r];this.propogateDistance(l)}}},{key:"setTarget",value:function(e){var t,a=Object(b.a)(this.nodes);try{for(a.s();!(t=a.n()).done;){t.value.distance=9e9}}catch(n){a.e(n)}finally{a.f()}this.nodes[e].distance=0,this.propogateDistance(e)}},{key:"findRoute",value:function(e){for(var t=[e],a=this.nodes[e];a.distance>0;){if(a.distance>=9e9)throw new Error("There is no path from the selected node to the target.");var n,i=Object(b.a)(a.connections);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=this.nodes[o];if(s.distance<a.distance){t.push(o),a=s;break}}}catch(r){i.e(r)}finally{i.f()}}return t}}]),e}(),De=function(){function e(t,a,n,i){Object(c.a)(this,e),this.bus=t,this.segments=void 0,this.segmentPathfind=void 0;var o=new Re(t,n,i);o.parse(a),this.segments=o.segments,this.segmentPathfind=new Ie(this.segments.length);for(var s=0;s<this.segments.length;s++)for(var r=this.segments[s],l=0;l<this.segments.length;l++){var u=this.segments[l];(r.x1===u.x1&&r.y1===u.y1||r.x1===u.x2&&r.y1===u.y2||r.x2===u.x1&&r.y2===u.y1||r.x2===u.x2&&r.y2===u.y2)&&this.segmentPathfind.addBidirectionalConnection(s,l)}}return Object(l.a)(e,[{key:"segmentIndexConnectedAt",value:function(e){var t,a=e.x,n=e.y,i=Object(b.a)(this.bus.connectedInputPins);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(e===o.p){a+=o.c.x,n+=o.c.y;break}}}catch(u){i.e(u)}finally{i.f()}var s,r=Object(b.a)(this.bus.connectedOutputPins);try{for(r.s();!(s=r.n()).done;){var c=s.value;if(e===c.p){a+=c.c.x,n+=c.c.y;break}}}catch(u){r.e(u)}finally{r.f()}var l=this.segments.findIndex(function(e){return e.x1===a&&e.y1===n||e.x2===a&&e.y2===n});if(-1===l)throw console.log(a,n,this.segments),new Error("Wire is not properly connected to component at "+e.name);return l}},{key:"render",value:function(e,t){return i.a.createElement(_e,{key:e,c:this,d:t})}}]),e}(),Me=function e(t,a,n,i){Object(c.a)(this,e),this.x1=t,this.y1=a,this.x2=n,this.y2=i},Re=function(){function e(t,a,n){Object(c.a)(this,e),this.bus=t,this.ins=a,this.outs=n,this.segments=[]}return Object(l.a)(e,[{key:"getInputPin",value:function(e){var t=this.bus.connectedOutputPins[e];return{x:t.c.x+t.p.x,y:t.c.y+t.p.y}}},{key:"getOutputPin",value:function(e){var t=this.bus.connectedInputPins[e];return{x:t.c.x+t.p.x,y:t.c.y+t.p.y}}},{key:"addSegment",value:function(e,t,a,n){this.segments.push(new Me(e,t,a,n))}},{key:"wireDescription",value:function(){return"Wire from "+this.ins.join(", ")+" to "+this.outs.join(", ")}},{key:"outputToInput",value:function(e){var t=this.getInputPin(0),a=t.x,n=t.y,i=this.getOutputPin(0),o=i.x,s=i.y,r=(a+o)/2,c=(n+s)/2;switch(e){case"H":if(n!==s)throw new Error("Emulator error: for wire, the connectors do not line up (".concat(n," vs ").concat(s,").")+"\nIn ".concat(this.wireDescription()));this.addSegment(a,n,o,s);break;case"V":if(a!==o)throw new Error("Emulator error: for wire, the connectors do not line up (".concat(a," vs ").concat(o,").")+"\nIn ".concat(this.wireDescription()));this.addSegment(a,n,o,s);break;case"HV":this.addSegment(a,n,o,n),this.addSegment(o,n,o,s);break;case"VH":this.addSegment(a,n,a,s),this.addSegment(a,s,o,s);break;case"HVH":this.addSegment(a,n,r,n),this.addSegment(r,n,r,s),this.addSegment(r,s,o,s);break;case"VHV":this.addSegment(a,n,a,c),this.addSegment(a,c,o,c),this.addSegment(o,c,o,s)}}},{key:"parse",value:function(e){for(var t,a=e.split(" "),n=0,i=0,o=0,s=0,r=0,c=[],l=0;l<a.length;l++){var u=a[l];if("H"===u||"V"===u||"HV"===u||"VH"===u||"HVH"===u||"VHV"===u)return void this.outputToInput(u);n=o,i=s;var d=void 0,h=void 0;switch(u){case"i":switch(t=parseInt(a[l+1]),a[l+2]){case"x":o=this.getInputPin(t).x;break;case"y":s=this.getInputPin(t).y;break;case"xy":o=this.getInputPin(t).x,s=this.getInputPin(t).y}l+=2;break;case"o":switch(t=parseInt(a[l+1]),a[l+2]){case"x":o=this.getOutputPin(t).x;break;case"y":s=this.getOutputPin(t).y;break;case"xy":o=this.getOutputPin(t).x,s=this.getOutputPin(t).y}l+=2;break;case"l":o-=parseInt(a[l+1]),l++;break;case"r":o+=parseInt(a[l+1]),l++;break;case"u":s-=parseInt(a[l+1]),l++;break;case"d":s+=parseInt(a[l+1]),l++;break;case"^":switch(d=parseInt(a[l+1]),a[l+2]){case"x":c[d]={val:o,isX:!0};break;case"y":c[d]={val:s,isX:!1};break;case"xy":c[d]={val:o,valy:s}}l+=2;continue;case"$":(h=c[d=parseInt(a[l+1])])&&(void 0!==h.valy?(o=h.val,s=h.valy):h.isX?o=h.val:s=h.val),l++;break;case"X":o=parseInt(a[l+1]),l++;break;case"Y":s=parseInt(a[l+1]),l++;break;case";":n=0,i=0,o=0,s=0,r=-1}1!==r?r++:this.addSegment(n,i,o,s)}}}]),e}(),_e=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.c,t=e.bus,a=t.displayValue,n="active";a===j.Inactive?n="inactive":a===j.Conflict?n="conflict":"0"!==a&&"false"!==a||(n+=" low"),n+=" wire";var o=new Array(e.segments.length).fill(!1);if(t.used&&void 0!==t.activeInput){var s=e.segmentIndexConnectedAt(t.activeInput);e.segmentPathfind.setTarget(s);var r,c=Object(b.a)(t.usedBy);try{for(c.s();!(r=c.n()).done;){var l,u=r.value,d=e.segmentIndexConnectedAt(u),h=e.segmentPathfind.findRoute(d),p=Object(b.a)(h);try{for(p.s();!(l=p.n()).done;){o[l.value]=!0}}catch(x){p.e(x)}finally{p.f()}}}catch(x){c.e(x)}finally{c.f()}}var f,v=[],y=0,m=Object(b.a)(this.props.c.segments);try{for(m.s();!(f=m.n()).done;){var g=f.value,O=o[y]?"used":"";v.push(i.a.createElement("line",Object.assign({key:y,className:O},g))),y++}}catch(x){m.e(x)}finally{m.f()}return i.a.createElement("g",{className:n},v)}}]),a}(i.a.Component),Be=new Map([["ALU",function(e,t,a,n,i){return new D(e,t,a,n,i)}],["And",function(e,t,a,n,i){return new le(e,t,a,n,i)}],["AndOr",function(e,t,a,n,i){return new pe(e,t,a,n,i)}],["Control",function(e,t,a,n,i){return new P(e,t,a,n,i)}],["Decoder",function(e,t,a,n,i){return new Y(e,t,a,n,i)}],["Expand",function(e,t,a,n,i){return new q(e,t,a,n,i)}],["FlagLogic",function(e,t,a,n,i){return new re(e,t,a,n,i)}],["Incrementer",function(e,t,a,n,i){return new ve(e,t,a,n,i)}],["Latch",function(e,t,a,n,i){return new me(e,t,a,n,i)}],["MainMemory",function(e,t,a,n,i){return new Oe(e,t,a,n,i)}],["Mux",function(e,t,a,n,i){return new xe(e,t,a,n,i)}],["Or",function(e,t,a,n,i){return new de(e,t,a,n,i)}],["Probe",function(e,t,a,n,i){return new we(e,t,a,n,i)}],["Tristate",function(e,t,a,n,i){return new Ee(e,t,a,n,i)}]]),Le=Object(f.a)("components"),Se=Object(f.a)("wires"),Pe=Object(f.a)("buses"),Te=function(){function e(){Object(c.a)(this,e),Object.defineProperty(this,Le,{writable:!0,value:[]}),Object.defineProperty(this,Se,{writable:!0,value:[]}),Object.defineProperty(this,Pe,{writable:!0,value:[]}),this.changeListener=function(){},this.width=800,this.height=600,this.visibleFlags=[],this.visibleRegisters=[],this.mainMemoryBlock=[],this.controls=[],this.decoder=void 0,this.lastMessage="Processor initialized.",this.lastMessageWasError=!1,this.haltRequested=!1,this.decoderCycleFinished=!1}return Object(l.a)(e,[{key:"loadDef",value:function(e){var t=this;Object(p.a)(this,Le)[Le]=[],Object(p.a)(this,Se)[Se]=[],Object(p.a)(this,Pe)[Pe]=[];var a,n=Object(b.a)(e.components);try{for(n.s();!(a=n.n()).done;){var i=a.value,o=Be.get(i.type);if(void 0===o)throw new Error("Emulator error: '".concat(i.type,"' is not a valid component type."));var s=o(this,i.id,i.x,i.y,i);s instanceof P&&this.controls.push(s),Object(p.a)(this,Le)[Le].push(s)}}catch(M){n.e(M)}finally{n.f()}var r,c,l=function(e){return Object(p.a)(t,Le)[Le].find(function(t){return t.id===e})},u=Object(b.a)(e.wires);try{for(u.s();!(r=u.n()).done;){var d,h=r.value,f=new B,v=Object(b.a)(h.inputs);try{for(v.s();!(d=v.n()).done;){var y=d.value.split("."),g=Object(m.a)(y,2),O=g[0],j=g[1],x=l(O);if(void 0===x)throw new Error("Emulator error: could not find a gate with id '".concat(O,"'."));x.connectOutput(j,f)}}catch(M){v.e(M)}finally{v.f()}var k,w=Object(b.a)(h.outputs);try{for(w.s();!(k=w.n()).done;){var C=k.value.split("."),E=Object(m.a)(C,2),N=E[0],A=E[1],I=l(N);if(void 0===I)throw new Error("Emulator error: could not find a gate with id '".concat(N,"'."));I.connectInput(A,f)}}catch(M){w.e(M)}finally{w.f()}var D=new De(f,h.path,h.inputs,h.outputs);Object(p.a)(this,Pe)[Pe].push(f),Object(p.a)(this,Se)[Se].push(D)}}catch(M){u.e(M)}finally{u.f()}(e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.microcode)&&(null===(c=this.decoder)||void 0===c||c.loadMicrocode(e.microcode));this.reset()}},{key:"addComponent",value:function(e){Object(p.a)(this,Le)[Le].push(e)}},{key:"addBus",value:function(e){Object(p.a)(this,Pe)[Pe].push(e)}},{key:"addWire",value:function(e){Object(p.a)(this,Se)[Se].push(e)}},{key:"reset",value:function(){this.clearHighlights();var e,t=Object(b.a)(Object(p.a)(this,Le)[Le]);try{for(t.s();!(e=t.n()).done;){e.value.reset()}}catch(a){t.e(a)}finally{t.f()}this.lastMessage="Processor reset.",this.lastMessageWasError=!1,this.eval()}},{key:"eval",value:function(){var e=this,t=void 0,a=void 0,n=function(n){for(var i=0;i<n;i++){var o,s=Object(b.a)(Object(p.a)(e,Le)[Le]);try{for(s.s();!(o=s.n()).done;){var r=o.value;try{r.eval()}catch(c){c instanceof I?void 0===t&&(t=c.message):void 0===a&&(t="Emulator error: encountered JavaScript exception, see console for details.",a=c)}}}catch(l){s.e(l)}finally{s.f()}}};n(5);var i,o=Object(b.a)(Object(p.a)(this,Pe)[Pe]);try{for(o.s();!(i=o.n()).done;){i.value.clearUsedBy()}}catch(s){o.e(s)}finally{o.f()}if(n(10),void 0!==t&&(this.lastMessage=t,this.lastMessageWasError=!0),this.changeListener(),void 0!==a)throw a}},{key:"clearHighlights",value:function(){var e,t=Object(b.a)(this.components);try{for(t.s();!(e=t.n()).done;){e.value.clearHighlights()}}catch(a){t.e(a)}finally{t.f()}}},{key:"clock",value:function(){var e=void 0,t=void 0;this.decoderCycleFinished=!1,this.haltRequested=!1;var a,n=Object(b.a)(Object(p.a)(this,Le)[Le]);try{for(n.s();!(a=n.n()).done;){var i=a.value;try{i.evalClock()}catch(o){o instanceof I?void 0===e&&(e=o.message):void 0===t&&(e="Emulator error: encountered JavaScript exception, see console for details.",t=o)}}}catch(s){n.e(s)}finally{n.f()}if(void 0!==e&&(this.lastMessage=e,this.lastMessageWasError=!0,this.changeListener()),void 0!==t)throw t}},{key:"components",get:function(){return Object(p.a)(this,Le)[Le]}},{key:"wires",get:function(){return Object(p.a)(this,Se)[Se]}},{key:"decoderEnabled",set:function(e){void 0!==this.decoder&&(this.decoder.enabled=e)},get:function(){var e;return(null===(e=this.decoder)||void 0===e?void 0:e.enabled)||!1}}]),e}(),Ve=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t=0,a=[],n=Object(b.a)(this.props.datapath.components);try{for(n.s();!(e=n.n()).done;){var o=e.value;a.push(o.render(o.id+t,this.props.datapath)),t+=1}}catch(h){n.e(h)}finally{n.f()}var s,r=Object(b.a)(this.props.datapath.wires);try{for(r.s();!(s=r.n()).done;){var c=s.value;a.push(c.render("wire"+t,this.props.datapath)),t+=1}}catch(h){r.e(h)}finally{r.f()}var l=this.props.datapath,u=l.width,d=l.height;return i.a.createElement("svg",{className:"datapath "+this.props.className,viewBox:"0 0 ".concat(u," ").concat(d)},a)}}]),a}(i.a.Component),Ue=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.datapath;return i.a.createElement(Ve,{className:y.a.datapathView,datapath:e})}}]),a}(i.a.Component),He=a(16),Ze=a.n(He),Fe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.cell.lastUseCssClass,a=this.props.cell.value,n=void 0===a?"?":a;return i.a.createElement("div",{onClick:function(t){return e.props.onClick()},className:Ze.a.root+(this.props.focused?" "+Ze.a.focused:"")+" "+t},n)}}]),a}(i.a.Component),$e=a(17),We=a.n($e),Je=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){for(var e=this,t=function(t){return i.a.createElement(Fe,{key:"item".concat(t),cell:e.props.memoryBlock[t],onClick:function(){return e.props.onClick(t)},focused:t===e.props.focusedIndex})},a=[],n=Math.ceil(this.props.memoryBlock.length/4),o=0;o<n;o++)a.push(i.a.createElement("span",{key:"label".concat(o),className:We.a.label},o)),a.push(t(o+0*n)),a.push(t(o+1*n)),a.push(t(o+2*n)),a.push(t(o+3*n));return i.a.createElement("div",{className:We.a.root},a)}}]),a}(i.a.Component),Qe=a(9),Ge=a.n(Qe),Ye=a(22),ze=a.n(Ye),qe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t=this.props.flag.value;return e=!0===t?"T":!1===t?"F":"?",i.a.createElement("div",{className:ze.a.root},e)}}]),a}(i.a.Component),Xe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).textBoxRef=i.a.createRef(),n.state={editing:{cell:e.datapath.mainMemoryBlock[0],memoryIndex:0},focusCell:function(e,t){n.setState(function(a){return a.editing.cell=e,a.editing.memoryIndex=t,a},function(){n.selectTextBox()})}},n}return Object(l.a)(a,[{key:"selectTextBox",value:function(){var e,t;null===(e=this.textBoxRef.current)||void 0===e||e.focus(),null===(t=this.textBoxRef.current)||void 0===t||t.select()}},{key:"shiftMemoryDown",value:function(e){for(var t=this.props.datapath.mainMemoryBlock,a=t.length-1;a>e;a--)t[a].value=t[a-1].value;t[e].value=void 0,this.forceUpdate()}},{key:"shiftMemoryUp",value:function(e){for(var t=this.props.datapath.mainMemoryBlock,a=e;a<t.length-1;a++)t[a].value=t[a+1].value;t[t.length-1].value=void 0,this.forceUpdate()}},{key:"render",value:function(){var e,t=this,a=this.props.datapath,n=this.state.editing.cell.label,o=void 0!==this.state.editing.memoryIndex,s=[],r=Object(b.a)(a.visibleRegisters);try{var c=function(){var a=e.value;s.push(i.a.createElement("div",{key:a.label+"_label",className:Ge.a.label},a.label)),s.push(i.a.createElement(Fe,{key:a.label+"_value",cell:a,onClick:function(){return t.state.focusCell(a,void 0)},focused:a===t.state.editing.cell}))};for(r.s();!(e=r.n()).done;)c()}catch(f){r.e(f)}finally{r.f()}var l,u=Object(b.a)(a.visibleFlags);try{for(u.s();!(l=u.n()).done;){var d=l.value;s.push(i.a.createElement("div",{key:d.label+"_label",className:Ge.a.label},d.label)),s.push(i.a.createElement(qe,{key:d.label+"_value",flag:d}))}}catch(f){u.e(f)}finally{u.f()}var h=this.state.editing.cell.value,p=void 0===h?"?":h;return i.a.createElement("div",{className:Ge.a.processor},i.a.createElement("div",{className:Ge.a.left_controls},s,i.a.createElement("div",null),i.a.createElement("div",{style:{height:"2em"}}),i.a.createElement("div",{className:Ge.a.label},"Selected:"),i.a.createElement("div",null,n),i.a.createElement("div",{className:Ge.a.label},"Value:"),i.a.createElement("input",{ref:this.textBoxRef,value:p,onChange:function(e){var a=e.target.value.toUpperCase();t.setState(function(e){return e.editing.cell.value="?"===a?void 0:a,t.props.datapath.eval(),e})},onKeyUp:function(e){"Enter"===e.key&&t.setState(function(e){return void 0===e.editing.memoryIndex?e:127===e.editing.memoryIndex?e:(e.editing.memoryIndex+=1,e.editing.cell=a.mainMemoryBlock[e.editing.memoryIndex],e)},function(){t.selectTextBox()})}}),i.a.createElement("div",null),i.a.createElement("button",{className:"flat-button",onClick:function(){return t.shiftMemoryUp(t.state.editing.memoryIndex||0)},disabled:!o},"Shift Up"),i.a.createElement("div",null),i.a.createElement("button",{className:"flat-button",onClick:function(){return t.shiftMemoryDown(t.state.editing.memoryIndex||0)},disabled:!o},"Shift Down"),i.a.createElement("div",null),i.a.createElement("div",{style:{height:"2em"}}),i.a.createElement("div",null),i.a.createElement("div",{className:Ge.a.key},i.a.createElement("span",{className:"use_read"},"Read"),i.a.createElement("span",{className:"use_write"},"Written"),i.a.createElement("br",null),i.a.createElement("span",{className:"use_instruction"},"Instruction"),i.a.createElement("span",{className:"use_jump_target"},"Jump Target"),i.a.createElement("br",null),i.a.createElement("span",{className:"use_address"},"Used As Address"),i.a.createElement("span",{className:"use_error"},"Error"))),i.a.createElement(Je,{memoryBlock:a.mainMemoryBlock,onClick:function(e){return t.state.focusCell(a.mainMemoryBlock[e],e)},focusedIndex:this.state.editing.memoryIndex}))}}]),a}(i.a.Component),Ke=a(10),et=a.n(Ke);function tt(e){return e.startsWith('"')&&e.endsWith('"')?e.substr(1,e.length-2):e}var at={saveMem:function(e){for(var t="",a=!0,n=0;n<e.length;n++){var i=e[n];void 0!==i.value&&(t+=a?",":n+",",t+=i.value+"\n"),a=void 0!==i.value}return t},loadMem:function(e,t){var a,n=Object(b.a)(e);try{for(n.s();!(a=n.n()).done;)a.value.value=void 0}catch(p){n.e(p)}finally{n.f()}var i="",o="",s=0,r=1;t+="\n";var c,l=Object(b.a)(t);try{for(l.s();!(c=l.n()).done;){var u=c.value;if("\r"!==u)if(1===r)if(","===u){var d=tt(i.trim());if(r=2,o="",0===d.length)continue;if(s=parseInt(d),isNaN(s))return i+" is not a valid number";if(s>=e.length)return s+" is too big, it is over "+(e.length-1);if(s<0)return s+" is too small, it is less than 0"}else i+=u;else if(2===r)if("\n"===u){if(r=1,i="",s>=e.length)continue;var h=tt(o.trim());if(0===h.length)continue;"?"!==h&&(e[s].value=h.toUpperCase()),s+=1}else o+=u}}catch(p){l.e(p)}finally{l.f()}return null}},nt=Object(f.a)("running"),it=Object(f.a)("fast"),ot=Object(f.a)("timer"),st=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),n=t.call(this,e),Object.defineProperty(Object(u.a)(n),nt,{writable:!0,value:!1}),Object.defineProperty(Object(u.a)(n),it,{writable:!0,value:!1}),Object.defineProperty(Object(u.a)(n),ot,{writable:!0,value:void 0}),n.state={datapathLayout:!1,flashStepBtn:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.datapath.changeListener=function(){return e.forceUpdate()}}},{key:"componentWillUnmount",value:function(){this.props.datapath.changeListener=function(){}}},{key:"loadFile",value:function(e){var t,a=this;this.reset();var n=null===(t=e.target.files)||void 0===t?void 0:t.item(0);n&&n.text().then(function(e){var t=a.props.datapath,n=at.loadMem(t.mainMemoryBlock,e);a.forceUpdate(),n&&alert("Error encountered while loading file:\n"+n),a.props.datapath.eval()})}},{key:"saveFile",value:function(){var e=this.props.datapath,t=at.saveMem(e.mainMemoryBlock),a=new Blob([t]),n=URL.createObjectURL(a),i=document.createElement("a");i.download="Memory.csv",i.type="text/csv",i.href=n,i.click(),i.remove(),this.props.datapath.eval()}},{key:"toggleLayout",value:function(){this.setState(function(e){return{datapathLayout:!e.datapathLayout}})}},{key:"startClock",value:function(e){Object(p.a)(this,it)[it]=e,!1===Object(p.a)(this,nt)[nt]&&(Object(p.a)(this,nt)[nt]=!0,this.timerTick())}},{key:"stopClock",value:function(){Object(p.a)(this,nt)[nt]&&(clearTimeout(Object(p.a)(this,ot)[ot]),Object(p.a)(this,nt)[nt]=!1,this.setState(function(e){return Object(r.a)(Object(r.a)({},e),{},{flashStepBtn:!1})}))}},{key:"timerTick",value:function(){var e=this;if(clearTimeout(Object(p.a)(this,ot)[ot]),Object(p.a)(this,ot)[ot]=void 0,this.state.flashStepBtn||this.doStep(),Object(p.a)(this,nt)[nt]){var t=Object(p.a)(this,it)[it]?100:1e3;Object(p.a)(this,ot)[ot]=window.setTimeout(function(){return e.timerTick()},t),this.setState(function(e){return Object(r.a)(Object(r.a)({},e),{},{flashStepBtn:!e.flashStepBtn})})}}},{key:"doStep",value:function(){this.props.datapath.clearHighlights(),this.props.datapath.clock(),this.props.datapath.eval(),this.props.datapath.haltRequested&&this.stopClock();var e=this.props.datapath;if(!this.state.datapathLayout){for(var t=50;!e.decoderCycleFinished&&t>0;)e.clock(),e.eval(),t--;if(0===t)throw new Error("Decoder did not finish in 50 cycles, probably a programming error.")}if(e.lastMessageWasError)this.stopClock();else if(e.decoderCycleFinished){var a;e.lastMessage=(null===(a=e.decoder)||void 0===a?void 0:a.getInstructionDescription())||"(No description provided for last instruction.)"}}},{key:"reset",value:function(){this.stopClock(),this.props.datapath.reset()}},{key:"render",value:function(){var e=this,t=this.props.datapath,a=this.state.datapathLayout?i.a.createElement(Ue,{datapath:t}):i.a.createElement(Xe,{datapath:t});return i.a.createElement("div",{className:et.a.root},a,i.a.createElement("div",{className:t.lastMessageWasError?et.a.error_message:et.a.info_message},t.lastMessage),i.a.createElement("div",{className:et.a.actions},i.a.createElement("button",{className:"flat-button"+(this.state.flashStepBtn?" pressed":""),onClick:function(){return e.doStep()}},this.state.datapathLayout?"Clock":"Step"),i.a.createElement("button",{className:"flat-button",onClick:function(){return e.startClock(!1)}},"Run"),i.a.createElement("button",{className:"flat-button",onClick:function(){return e.startClock(!0)}},"Run Fast"),i.a.createElement("button",{className:"flat-button",onClick:function(){return e.stopClock()}},"Stop"),i.a.createElement("button",{className:"flat-button",onClick:function(){return e.reset()}},"Reset"),i.a.createElement("button",{className:"flat-button",onClick:function(){return e.saveFile()}},"Save Memory"),i.a.createElement("label",{className:"flat-button",htmlFor:"file"},"Load Memory"),i.a.createElement("input",{onChange:function(t){return e.loadFile(t)},id:"file",type:"file",accept:".csv",className:et.a.semi_hidden}),i.a.createElement("button",{className:"flat-button "+et.a.switch_view_button,onClick:function(){return e.toggleLayout()}},"Switch To ",this.state.datapathLayout?"Programmer":"Datapath"," View")))}}]),a}(i.a.Component),rt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ct(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var lt={width:800,height:500,components:[{type:"Mux",id:"MIncSel",x:30,y:75},{type:"Control",id:"IncSel",name:"incsel",x:15,y:135,wid:50,top:!0},{type:"Incrementer",id:"Plus1",x:90,y:85,nbits:7,constant:1},{type:"Expand",id:"ExPC",x:100,y:125,inNBits:12,outNBits:7,extend:!1},{type:"Mux",id:"MPC",x:160,y:90},{type:"Control",id:"PCSel",name:"psel",x:150,y:150,wid:40,top:!0},{type:"Latch",id:"PC",name:"PC",x:270,y:105,nbits:7,resetValue:0,visible:!0,signed:!1},{type:"AndOr",id:"LPC",x:220,y:195},{type:"Control",id:"FLdPC",name:"fldpc",x:150,y:175,wid:50,top:!1},{type:"Control",id:"CLdPC",name:"cldpc",x:150,y:200,wid:50,top:!1},{type:"Expand",id:"ExPCOut",x:330,y:145,inNBits:7,outNBits:12,extend:!1},{type:"Tristate",id:"PC2A",x:370,y:60,flip:!1},{type:"Control",id:"RdPCA",name:"rdpca",x:360,y:110,wid:50,top:!0},{type:"Tristate",id:"PC2B",x:370,y:150,flip:!1},{type:"Control",id:"RdPCB",name:"rdpcb",x:360,y:200,wid:50,top:!0},{type:"Latch",id:"ACC",name:"ACC",x:180,y:340,nbits:12,visible:!0},{type:"Expand",id:"ExS",x:470,y:55,inNBits:12,outNBits:7,extend:!1},{type:"Latch",id:"S",name:"S",x:530,y:70,nbits:7,signed:!1},{type:"Control",id:"LdS",name:"lds",x:520,y:130,wid:40,top:!0},{type:"Tristate",id:"S2A",x:590,y:60,flip:!1},{type:"Control",id:"RdS",name:"rds",x:585,y:130,wid:40,top:!0},{type:"Latch",id:"IR",name:"IR",x:470,y:180,visible:!0},{type:"Control",id:"LdIR",name:"ldir",x:460,y:240,wid:40,top:!0},{type:"Expand",id:"ExIR",x:540,y:165,inNBits:12,outNBits:7,extend:!1},{type:"Decoder",id:"Dec",x:540,y:225},{type:"Tristate",id:"IR2A",x:610,y:170,flip:!1},{type:"Control",id:"RdIR",name:"rdir",x:605,y:225,wid:40,top:!0},{type:"Latch",id:"Q",name:"Q",x:50,y:355,nbits:12,visible:!0},{type:"Control",id:"LdQ",name:"ldq",x:40,y:415,wid:40,top:!0},{type:"Mux",id:"MAcc",x:120,y:325},{type:"Control",id:"ASel",name:"asel",x:110,y:385,wid:40,top:!0},{type:"Control",id:"LdA",name:"lda",x:170,y:400,wid:40,top:!0},{type:"ALU",id:"ALU",x:250,y:335,nbits:12},{type:"FlagLogic",id:"Flags",x:240,y:285},{type:"Control",id:"AOp",name:"op",x:240,y:435,wid:60,top:!0,options:["ADD","AND","INC","INCB","DEC","DECB","CMA","NEG","RAL","RAR","ZERO","ONES"]},{type:"Control",id:"FOp",name:"fop",x:160,y:290,wid:60,top:!1,options:["RDTZ","RDC","RDZ","RDN","RDV","RDNC","RDNZ","RDNN","RDNV","ROT","LDZ","LDALL","LDTZ","CLC","STC","CMC"]},{type:"Tristate",id:"Acc2D",x:350,y:305,flip:!1},{type:"Control",id:"RdA",name:"rda",x:345,y:355,wid:40,top:!0},{type:"Mux",id:"MT",x:350,y:395},{type:"Control",id:"TSel",name:"tsel",x:340,y:455,wid:40,top:!0},{type:"Probe",id:"ViewALU",x:340,y:270,wid:80},{type:"Latch",id:"T",name:"T",x:400,y:395,nbits:12},{type:"Control",id:"LdT",name:"ldt",x:390,y:455,wid:40,top:!0},{type:"Tristate",id:"T2D",x:460,y:385,flip:!1},{type:"Control",id:"RdT",name:"rdt",x:455,y:435,wid:40,top:!0},{type:"Tristate",id:"ADrv",x:680,y:10,flip:!1},{type:"Control",id:"AOut",name:"aout",x:675,y:60,wid:40,top:!0},{type:"Tristate",id:"DinDrv",x:460,y:300,flip:!0},{type:"Control",id:"Din",name:"din",x:455,y:345,wid:40,top:!0},{type:"Tristate",id:"DoutDrv",x:510,y:270,flip:!1},{type:"Control",id:"Dout",name:"dout",x:505,y:345,wid:40,top:!0},{type:"MainMemory",id:"Mem",x:760,y:0,databits:12,addrbits:7,addrY:30,memrY:110,memwY:135,dataY:290},{type:"Control",id:"MemR",name:"memr",x:675,y:100,wid:60,top:!1},{type:"Control",id:"MemW",name:"memw",x:675,y:125,wid:60,top:!1},{type:"Control",id:"HltI",name:"hlti",x:675,y:390,wid:60,top:!1},{type:"Control",id:"HltJ",name:"hltj",x:675,y:415,wid:60,top:!1},{type:"Control",id:"HltA",name:"hlta",x:675,y:440,wid:60,top:!1}],wires:[{inputs:["IncSel.out"],outputs:["MIncSel.sel"],path:"V"},{inputs:["MIncSel.out"],outputs:["Plus1.in"],path:"H"},{inputs:["PCSel.out"],outputs:["MPC.sel"],path:"V"},{inputs:["Plus1.out"],outputs:["MPC.in0"],path:"H"},{inputs:["ExPC.out"],outputs:["MPC.in1"],path:"HVH"},{inputs:["MPC.out"],outputs:["PC.in"],path:"H"},{inputs:["LPC.out"],outputs:["PC.load"],path:"HV"},{inputs:["FLdPC.out"],outputs:["LPC.in0"],path:"HVH"},{inputs:["CLdPC.out"],outputs:["LPC.in1"],path:"HVH"},{inputs:["RdPCA.out"],outputs:["PC2A.enable"],path:"V"},{inputs:["RdPCB.out"],outputs:["PC2B.enable"],path:"V"},{inputs:["ExPCOut.out"],outputs:["PC2B.in"],path:"H"},{inputs:["PC.out"],outputs:["MIncSel.in0","PC2A.in","ExPCOut.in"],path:"o 0 xy l 10 u 30 r 300 o 1 y i 0 y o 2 y o 2 xy ; i 0 xy r 20 ; o 1 xy l 50"},{inputs:["ExS.out"],outputs:["S.in"],path:"H"},{inputs:["LdS.out"],outputs:["S.load"],path:"V"},{inputs:["RdS.out"],outputs:["S2A.enable"],path:"V"},{inputs:["S.out"],outputs:["S2A.in"],path:"H"},{inputs:["LdIR.out"],outputs:["IR.load"],path:"V"},{inputs:["ExIR.out"],outputs:["IR2A.in"],path:"H"},{inputs:["RdIR.out"],outputs:["IR2A.enable"],path:"V"},{inputs:["IR.out"],outputs:["ExIR.in","Dec.in"],path:"i 0 xy r 20 ^ 0 xy o 0 xy ; $ 0 o 1 y o 1 xy"},{inputs:["LdQ.out"],outputs:["Q.load"],path:"V"},{inputs:["Q.out"],outputs:["MAcc.in1"],path:"H"},{inputs:["ASel.out"],outputs:["MAcc.sel"],path:"V"},{inputs:["LdA.out"],outputs:["ACC.load"],path:"V"},{inputs:["MAcc.out"],outputs:["ACC.in"],path:"H"},{inputs:["ALU.flags"],outputs:["Flags.in"],path:"HVH"},{inputs:["AOp.out"],outputs:["ALU.op"],path:"V"},{inputs:["FOp.out"],outputs:["Flags.op"],path:"H"},{inputs:["Flags.out"],outputs:["ALU.cin","LPC.in2"],path:"i 0 xy u 10 ^ 0 xy r 40 d 150 o 0 x o 0 xy ; $ 0 o 1 x l 10 o 1 y o 1 xy"},{inputs:["RdA.out"],outputs:["Acc2D.enable"],path:"V"},{inputs:["ACC.out"],outputs:["ALU.in0","Acc2D.in"],path:"i 0 xy r 20 ^ 0 xy ^ 1 x o 0 xy ; o 1 xy $ 1 $ 0"},{inputs:["TSel.out"],outputs:["MT.sel"],path:"V"},{inputs:["ALU.out"],outputs:["MT.in1","MAcc.in0","ViewALU.in"],path:"o 1 xy l 20 u 70 r 220 ^ 0 x o 2 y i 0 y o 0 y o 0 xy ; i 0 xy $ 0 ; o 2 xy $ 0"},{inputs:["LdT.out"],outputs:["T.load"],path:"V"},{inputs:["MT.out"],outputs:["T.in"],path:"HVH"},{inputs:["RdT.out"],outputs:["T2D.enable"],path:"V"},{inputs:["T.out"],outputs:["T2D.in","ALU.in1"],path:"i 0 xy r 15 ^ 0 xy o 0 xy ; $ 0 d 80 l 215 o 1 y o 1 xy"},{inputs:["AOut.out"],outputs:["ADrv.enable"],path:"V"},{inputs:["PC2A.out","S2A.out","IR2A.out"],outputs:["ADrv.in","MIncSel.in1"],path:"i 0 xy r 20 o 0 y ^ 0 x ; i 2 xy r 20 i 1 y ^ 1 x ; i 1 xy $ 1 o 0 y ; o 1 xy l 20 o 0 y $ 0 $ 1 o 0 xy"},{inputs:["Din.out"],outputs:["DinDrv.enable"],path:"V"},{inputs:["Dout.out"],outputs:["DoutDrv.enable"],path:"V"},{inputs:["Acc2D.out","PC2B.out","T2D.out","DinDrv.out"],outputs:["Q.in","ExPC.in","ExS.in","IR.in","MT.in0","DoutDrv.in"],path:"o 0 xy l 10 u 115 ^ 0 y ^ 2 xy ; o 1 xy l 20 $ 0 ^ 3 xy $ 2 ; o 4 xy l 20 $ 0 ^ 4 xy $ 3 ; o 3 xy l 30 ^ 1 x ^ 5 xy $ 0 ^ 6 xy $ 4 ; i 1 xy $ 1 ^ 7 xy $ 5 ; o 2 xy $ 1 $ 7 ; o 5 xy $ 1 ^ 8 xy $ 6 ; i 3 xy $ 1 ^ 9 xy $ 8 ; i 0 xy $ 1 ^ 10 xy $ 9 ; i 2 xy r 20 u 30 $ 1 $ 10"},{inputs:["ADrv.out"],outputs:["Mem.addr"],path:"H"},{inputs:["DoutDrv.out","Mem.dout"],outputs:["Mem.din","DinDrv.in"],path:"o 1 xy r 70 i 0 y ^ 0 x ; i 1 xy l 20 i 0 y ^ 1 x ; i 0 xy $ 0 $ 1 o 0 xy"},{inputs:["MemR.out"],outputs:["Mem.memr"],path:"H"},{inputs:["MemW.out"],outputs:["Mem.memw"],path:"H"},{inputs:["HltI.out"],outputs:["Mem.highlight_instr"],path:"H"},{inputs:["HltJ.out"],outputs:["Mem.highlight_jumpt"],path:"H"},{inputs:["HltA.out"],outputs:["Mem.highlight_addr"],path:"H"}],microcode:{clockCycleNames:["t0 (fetch)","t1","t2","t3","t4","t5"],fetchCycleStep:"rdpca,aout,memr,din,ldir,hlti",instructions:["<T> from MEM[<ExIR>] is ANDed to ACC.;AND;rdir,aout,memr,din,ldt;op:AND,fop:LDZ,lda;fldpc","<T> from MEM[<PC-1>] is ANDed to ACC.;ANDI;fldpc;rdpca,aout,memr,din,ldt;op:AND,fop:LDZ,lda;fldpc","<T> from MEM[<S>] is ANDed to ACC.;ANDR;rdir,aout,memr,hlta,din,lds;rds,aout,memr,din,ldt;op:AND,fop:LDZ,lda;fldpc","<T> from MEM[<ExIR>] is added to ACC.;TAD;rdir,aout,memr,din,ldt;op:ADD,fop:LDALL,lda;fldpc","<T> from MEM[<PC-1>] is added to ACC.;TADI;fldpc;rdpca,aout,memr,din,ldt;op:ADD,fop:LDALL,lda;fldpc","<T> from MEM[<S>] is added to ACC.;TADR;rdir,aout,memr,hlta,din,lds;rds,aout,memr,din,ldt;op:ADD,fop:LDALL,lda;fldpc","Incremented MEM[<ExIR>] to <T>, <Flags?skipped over:continued to> next instruction.;ISZ;fldpc,rdir,aout,memr,din,ldt;op:INCB,fop:LDZ,tsel,ldt;rdir,aout,memw,rdt,dout,cldpc,fop:RDZ,!message;rdpca,aout,hltj","Incremented MEM[<S>] to <T>, <Flags?skipped over:continued to> next instruction.;ISZR;fldpc,rdir,aout,memr,hlta,din,lds;rds,aout,memr,din,ldt;op:INCB,fop:LDZ,tsel,ldt;rds,aout,memw,rdt,dout,cldpc,fop:RDZ;rdpca,aout,hltj,!message","Wrote <ACC> to MEM[<ExIR>] and cleared ACC.;DCA;rdir,aout,memw,rda,dout,!message;op:ZERO,lda;fldpc","Wrote <ACC> to MEM[<S>] and cleared ACC.;DCAR;rdir,aout,memr,hlta,din,lds;rds,aout,memw,rda,dout,!message;op:ZERO,lda;fldpc","Jumped to subroutine at MEM[<ExIR+1>], placing return address at MEM[<ExIR>].;JMS;fldpc;rdir,aout,memw,rdpcb,dout;rdir,incsel,fldpc;rdpca,aout,hltj","Jumped to subroutine at MEM[<S+1>], placing return address at MEM[<S>].;JMSR;fldpc,rdir,aout,memr,hlta,din,lds;rds,aout,memw,rdpcb,dout;rds,incsel,fldpc,!message;rdpca,aout,hltj","Jumped to MEM[<PC>].;JMP;rdir,incsel,fldpc,aout,hltj;rdpcb,ldt;op:DECB,tsel,ldt,!message;rdt,psel,fldpc","Jumped to MEM[<PC>].;JMPR;rdir,aout,memr,hlta,din,psel,fldpc,!message;rdpca,aout,hltj","Did nothing.;NOP;fldpc","Incremented accumulator.;IAC;op:INC,fop:LDALL,lda;fldpc","Shifted accumulator left through carry.;RAL;op:RAL,fop:ROT,lda;fldpc","Shifted accumulator right through carry.;RAR;op:RAR,fop:ROT,lda;fldpc","Complemeted accumulator.;CMA;op:CMA,lda;fldpc","Negated accumulator.;CIA;op:NEG,lda;fldpc","Cleared accumulator;CLA;op:ZERO,lda;fldpc","Set accumulator.;STA;op:ONES,lda;fldpc","Cleared carry flag.;CLC;fop:CLC;fldpc","Set carry flag.;STC;fop:STC;fldpc","Complemented carry flag.;CMC;fop:CMC;fldpc","Skipped over the next instruction.;SKP;fldpc;fldpc","<Flags?Skipped over:Continued to> the next instruction because the carry flag was <Flags?not set:set>.;SCC;fop:RDNC,cldpc,!message;fldpc;rdpca,aout,hltj","<Flags?Skipped over:Continued to> the next instruction because the carry flag was <Flags?set:not set>.;SCS;fop:RDC,cldpc,!message;fldpc;rdpca,aout,hltj","<Flags?Skipped over:Continued to> the next instruction because the zero flag was <Flags?not set:set>.;SZC;fop:RDNZ,cldpc,!message;fldpc;rdpca,aout,hltj","<Flags?Skipped over:Continued to> the next instruction because the zero flag was <Flags?set:not set>.;SZS;fop:RDZ,cldpc,!message;fldpc;rdpca,aout,hltj","<Flags?Skipped over:Continued to> the next instruction because the negative flag was <Flags?not set:set>.;SNC;fop:RDNN,cldpc,!message;fldpc;rdpca,aout,hltj","<Flags?Skipped over:Continued to> the next instruction because the negative flag was <Flags?set:not set>.;SNS;fop:RDN,cldpc,!message;fldpc;rdpca,aout,hltj","Copied the value of Q into A.;MQA;asel,lda;fldpc","Copied the value of A into Q.;MQL;rda,ldq;fldpc","Swapped the values of A and Q.;SWP;rda,ldt;asel,lda;rdt,ldq;fldpc"]}},ut=new Te;ut.loadDef(lt),s.a.render(i.a.createElement(st,{datapath:ut}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");rt?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ct(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ct(t,e)})}}()}],[[24,1,2]]]);
//# sourceMappingURL=main.5be82192.chunk.js.map